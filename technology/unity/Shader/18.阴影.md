#### 18.阴影
![](pic/40.png)  

1.先更新相机的深度纹理图ShadowMap,如下图： 

![](pic/41.png)  
这里深度图中颜色越深代表z越大  
2.渲染得到平行光的阴影映射纹理(相当于平行光的位置放一个摄像头)  
![](pic/42.png)  

3.根据上面两个纹理得到屏幕空间的阴影图。  

![](pic/43.png)  

如何根据1,2->3 呢，如图1一点通过深度测试片元A,将该点转换到光源空间，得到其光源空间下深度值z，使用其xy分量对平行光的阴影映射纹理进行采样，得到纹理中该方向深度z',如果z > z‘ ,说明该点在阴影中。这样就绘制出了屏幕空间的阴影图3.

